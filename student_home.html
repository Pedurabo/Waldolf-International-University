<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Dashboard - Waldorf Colleges & Universities</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        .navbar {
            background: linear-gradient(135deg, #2c5530 0%, #3e7b3e 100%);
            color: white;
            padding: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .nav-brand {
            font-size: 1.5em;
            font-weight: bold;
        }

        .nav-user {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-info {
            text-align: right;
        }

        .user-name {
            font-weight: 600;
            font-size: 1.1em;
        }

        .user-id {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .logout-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .logout-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .welcome-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .welcome-title {
            font-size: 2.2em;
            margin-bottom: 10px;
        }

        .welcome-subtitle {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.12);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-icon {
            font-size: 2em;
            margin-right: 15px;
        }

        .card-title {
            font-size: 1.3em;
            color: #2c5530;
            font-weight: 600;
        }

        .card-content {
            color: #666;
            line-height: 1.6;
        }

        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .stat-number {
            font-size: 1.8em;
            font-weight: bold;
            color: #2c5530;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, #2c5530 0%, #3e7b3e 100%);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #1e3a23 0%, #2c5530 100%);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        .course-list {
            list-style: none;
        }

        .course-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }

        .course-item:last-child {
            border-bottom: none;
        }

        .course-info h4 {
            color: #2c5530;
            margin-bottom: 5px;
        }

        .course-info p {
            color: #666;
            font-size: 0.9em;
        }

        .course-grade {
            font-weight: bold;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9em;
        }

        .grade-a { background: #d4edda; color: #155724; }
        .grade-b { background: #d1ecf1; color: #0c5460; }
        .grade-c { background: #fff3cd; color: #856404; }

        .schedule-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .schedule-table th,
        .schedule-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .schedule-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c5530;
        }

        .current-class {
            background: #e8f5e8;
            font-weight: 600;
        }

        .announcements {
            max-height: 300px;
            overflow-y: auto;
        }

        .announcement-item {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #2c5530;
        }

        .announcement-date {
            font-size: 0.8em;
            color: #666;
            margin-bottom: 5px;
        }

        .announcement-title {
            font-weight: 600;
            color: #2c5530;
            margin-bottom: 8px;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .quick-action {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .quick-action:hover {
            border-color: #2c5530;
            transform: translateY(-3px);
        }

        .quick-action-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #2c5530;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2c5530, #3e7b3e);
            transition: width 0.3s ease;
        }

        /* Enhanced Transcript Styles */
        .transcript-container {
            background: white;
            border: 2px solid #2c5530;
            border-radius: 10px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            font-family: 'Times New Roman', serif;
        }

        .transcript-header {
            text-align: center;
            border-bottom: 3px solid #2c5530;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .transcript-logo {
            font-size: 2.5em;
            color: #2c5530;
            margin-bottom: 10px;
        }

        .transcript-title {
            font-size: 1.8em;
            font-weight: bold;
            color: #2c5530;
            margin-bottom: 5px;
        }

        .transcript-subtitle {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 15px;
        }

        .transcript-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .transcript-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #2c5530;
        }

        .transcript-section h4 {
            color: #2c5530;
            margin-bottom: 15px;
            font-size: 1.2em;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
        }

        .transcript-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .transcript-table th {
            background: linear-gradient(135deg, #2c5530, #3e7b3e);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .transcript-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        .transcript-table tr:hover {
            background: #f8f9fa;
        }

        .grade-highlight {
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 20px;
            color: white;
        }

        .grade-a { background: #27ae60; }
        .grade-b { background: #3498db; }
        .grade-c { background: #f39c12; }
        .grade-d { background: #e67e22; }
        .grade-f { background: #e74c3c; }

        .transcript-summary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .summary-stat {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .summary-stat h3 {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .summary-stat p {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .transcript-footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #ddd;
            color: #666;
            font-size: 0.9em;
        }

        .transcript-actions {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .enhanced-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            animation: fadeIn 0.3s ease;
        }

        .enhanced-modal-content {
            background: white;
            border-radius: 15px;
            padding: 0;
            max-width: 95vw;
            max-height: 95vh;
            overflow-y: auto;
            position: relative;
            animation: slideIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: scale(0.8) translateY(-50px); opacity: 0; }
            to { transform: scale(1) translateY(0); opacity: 1; }
        }

        .modal-header {
            background: linear-gradient(135deg, #2c5530, #3e7b3e);
            color: white;
            padding: 20px 30px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: rgba(255,255,255,0.2);
        }

        .modal-body {
            padding: 30px;
        }

        .semester-section {
            margin-bottom: 30px;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }

        .semester-header {
            background: #2c5530;
            color: white;
            padding: 15px 20px;
            font-weight: 600;
            font-size: 1.1em;
        }

        .semester-content {
            padding: 20px;
        }

        .course-row {
            display: grid;
            grid-template-columns: 2fr 1fr 80px 80px 100px;
            gap: 15px;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
            align-items: center;
        }

        .course-row:last-child {
            border-bottom: none;
        }

        .course-details h5 {
            color: #2c5530;
            margin-bottom: 5px;
        }

        .course-details p {
            color: #666;
            font-size: 0.9em;
            margin: 0;
        }

        .print-styles {
            display: none;
        }

        @media print {
            .print-styles {
                display: block;
            }
            .no-print {
                display: none !important;
            }
            .enhanced-modal {
                position: static;
                background: white;
            }
            .enhanced-modal-content {
                max-width: 100%;
                max-height: 100%;
                box-shadow: none;
            }
            .modal-header {
                background: white;
                color: #2c5530;
                border-bottom: 2px solid #2c5530;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">üéì Waldorf Student Portal</div>
            <div class="nav-user">
                <div class="user-info">
                    <div class="user-name" id="userName">Loading...</div>
                    <div class="user-id" id="userId">Student ID</div>
                </div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Welcome Section -->
        <div class="welcome-section">
            <h1 class="welcome-title">Welcome Back, <span id="welcomeName">Student</span>!</h1>
            <p class="welcome-subtitle">Ready to continue your academic journey today?</p>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Academic Overview -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon">üìä</div>
                    <div class="card-title">Academic Overview</div>
                </div>
                <div class="card-content">
                    <div class="quick-stats">
                        <div class="stat-item">
                            <div class="stat-number" id="currentGPA">3.8</div>
                            <div class="stat-label">Current GPA</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="creditsEarned">45</div>
                            <div class="stat-label">Credits Earned</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="semesterRank">12</div>
                            <div class="stat-label">Class Rank</div>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="viewTranscript()">View Transcript</button>
                        <button class="btn btn-secondary" onclick="viewGrades()">Check Grades</button>
                    </div>
                </div>
            </div>

            <!-- Current Courses -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon">üìö</div>
                    <div class="card-title">Current Courses</div>
                </div>
                <div class="card-content">
                    <ul class="course-list" id="courseList">
                        <!-- Courses will be loaded here -->
                    </ul>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="enrollCourses()">Enroll in Courses</button>
                        <button class="btn btn-secondary" onclick="viewAllCourses()">View All</button>
                    </div>
                </div>
            </div>

            <!-- Today's Schedule -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon">üìÖ</div>
                    <div class="card-title">Today's Schedule</div>
                </div>
                <div class="card-content">
                    <table class="schedule-table">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Course</th>
                                <th>Room</th>
                            </tr>
                        </thead>
                        <tbody id="scheduleTable">
                            <!-- Schedule will be loaded here -->
                        </tbody>
                    </table>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="viewFullSchedule()">Full Schedule</button>
                    </div>
                </div>
            </div>

            <!-- Announcements -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon">üì¢</div>
                    <div class="card-title">Recent Announcements</div>
                </div>
                <div class="card-content">
                    <div class="announcements" id="announcementsList">
                        <!-- Announcements will be loaded here -->
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="viewAllAnnouncements()">View All</button>
                    </div>
                </div>
            </div>

            <!-- Academic Progress -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon">üéØ</div>
                    <div class="card-title">Academic Progress</div>
                </div>
                <div class="card-content">
                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>Degree Progress</span>
                            <span id="degreeProgress">37%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 37%"></div>
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>This Semester</span>
                            <span>85%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 85%"></div>
                        </div>
                    </div>
                    <p><strong>Expected Graduation:</strong> May 2026</p>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon">‚ö°</div>
                    <div class="card-title">Quick Actions</div>
                </div>
                <div class="card-content">
                    <div class="quick-actions">
                        <div class="quick-action" onclick="payTuition()">
                            <div class="quick-action-icon">üí≥</div>
                            <div>Pay Tuition</div>
                        </div>
                        <div class="quick-action" onclick="requestTranscript()">
                            <div class="quick-action-icon">üìã</div>
                            <div>Request Transcript</div>
                        </div>
                        <div class="quick-action" onclick="updateProfile()">
                            <div class="quick-action-icon">üë§</div>
                            <div>Update Profile</div>
                        </div>
                        <div class="quick-action" onclick="contactSupport()">
                            <div class="quick-action-icon">üí¨</div>
                            <div>Contact Support</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced student data management
        let currentStudent = JSON.parse(localStorage.getItem('currentStudent') || '{}');
        let isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';

        // Demo login fallback if no student logged in
        if (!isLoggedIn || !currentStudent.id) {
            currentStudent = { id: 'WU001', name: 'Alice Johnson' };
            isLoggedIn = true;
            localStorage.setItem('currentStudent', JSON.stringify(currentStudent));
            localStorage.setItem('isLoggedIn', 'true');
        }

        // Comprehensive student database with enhanced academic history
        const studentDatabase = {
            'WU001': {
                name: 'Alice Johnson',
                studentId: 'WU001',
                major: 'Computer Science',
                minor: 'Mathematics',
                year: 'Junior',
                enrollmentDate: 'Fall 2022',
                expectedGraduation: 'May 2026',
                gpa: 3.8,
                cumulativeGPA: 3.75,
                credits: 75,
                totalCreditsNeeded: 120,
                rank: 12,
                degreeProgress: 62.5,
                academicStanding: 'Good Standing',
                honors: ['Dean\'s List Fall 2023', 'President\'s Honor Roll Spring 2023'],
                address: '123 College Avenue, University City, ST 12345',
                phone: '(555) 123-4567',
                email: 'alice.johnson@waldorf.edu',
                dateOfBirth: 'March 15, 2003',
                financials: {
                    tuitionBalance: 2850,
                    scholarships: ['Merit Scholarship - $5000', 'Tech Grant - $2500'],
                    paymentStatus: 'Current'
                },
                academicHistory: {
                    'Fall 2022': {
                        semesterGPA: 3.6,
                        credits: 15,
                courses: [
                            { name: 'Introduction to Computer Science', code: 'CS101', grade: 'A-', credits: 3, instructor: 'Dr. Martinez' },
                            { name: 'Calculus I', code: 'MATH101', grade: 'B+', credits: 4, instructor: 'Prof. Anderson' },
                            { name: 'English Composition', code: 'ENG101', grade: 'A', credits: 3, instructor: 'Dr. Williams' },
                            { name: 'Chemistry I', code: 'CHEM101', grade: 'B', credits: 4, instructor: 'Prof. Davis' },
                            { name: 'First Year Seminar', code: 'FYS101', grade: 'A', credits: 1, instructor: 'Dr. Smith' }
                        ]
                    },
                    'Spring 2023': {
                        semesterGPA: 3.9,
                        credits: 16,
                        courses: [
                            { name: 'Programming Fundamentals', code: 'CS102', grade: 'A', credits: 4, instructor: 'Dr. Thompson' },
                            { name: 'Calculus II', code: 'MATH102', grade: 'A-', credits: 4, instructor: 'Prof. Rodriguez' },
                            { name: 'Physics I', code: 'PHYS101', grade: 'A', credits: 4, instructor: 'Dr. Chen' },
                            { name: 'Psychology', code: 'PSY101', grade: 'A', credits: 3, instructor: 'Prof. Taylor' },
                            { name: 'Discrete Mathematics', code: 'MATH150', grade: 'B+', credits: 1, instructor: 'Dr. Kumar' }
                        ]
                    },
                    'Fall 2023': {
                        semesterGPA: 3.7,
                        credits: 17,
                        courses: [
                            { name: 'Object-Oriented Programming', code: 'CS201', grade: 'A', credits: 4, instructor: 'Dr. Wilson' },
                            { name: 'Linear Algebra', code: 'MATH201', grade: 'B+', credits: 3, instructor: 'Prof. Garcia' },
                            { name: 'Statistics', code: 'STAT201', grade: 'A-', credits: 3, instructor: 'Dr. Lee' },
                            { name: 'History of Science', code: 'HIST205', grade: 'A', credits: 3, instructor: 'Prof. Brown' },
                            { name: 'Computer Architecture', code: 'CS210', grade: 'B+', credits: 4, instructor: 'Dr. Johnson' }
                        ]
                    },
                    'Spring 2024': {
                        semesterGPA: 3.8,
                        credits: 15,
                        courses: [
                            { name: 'Algorithms & Complexity', code: 'CS250', grade: 'A-', credits: 4, instructor: 'Dr. Smith' },
                            { name: 'Differential Equations', code: 'MATH250', grade: 'B+', credits: 3, instructor: 'Prof. White' },
                            { name: 'Software Engineering', code: 'CS260', grade: 'A', credits: 4, instructor: 'Dr. Miller' },
                            { name: 'Philosophy of Ethics', code: 'PHIL201', grade: 'A', credits: 3, instructor: 'Prof. Davis' },
                            { name: 'Web Development', code: 'CS215', grade: 'A', credits: 1, instructor: 'Dr. Adams' }
                        ]
                    },
                    'Fall 2024': {
                        semesterGPA: 3.8,
                        credits: 17,
                        courses: [
                            { name: 'Data Structures & Algorithms', code: 'CS301', grade: 'A', credits: 4, instructor: 'Dr. Smith' },
                            { name: 'Calculus III', code: 'MATH301', grade: 'B+', credits: 4, instructor: 'Prof. Johnson' },
                            { name: 'Physics II', code: 'PHYS202', grade: 'A-', credits: 3, instructor: 'Dr. Brown' },
                            { name: 'Technical Writing', code: 'ENG301', grade: 'A', credits: 3, instructor: 'Prof. Davis' },
                            { name: 'Database Systems', code: 'CS350', grade: 'A-', credits: 3, instructor: 'Dr. Wilson' }
                        ]
                    }
                },
                courses: [
                    { name: 'Data Structures & Algorithms', code: 'CS301', grade: 'A', credits: 4, instructor: 'Dr. Smith', room: 'CS-101', time: 'MWF 9:00-9:50 AM' },
                    { name: 'Calculus III', code: 'MATH301', grade: 'B+', credits: 4, instructor: 'Prof. Johnson', room: 'MATH-205', time: 'TTh 11:00-12:15 PM' },
                    { name: 'Physics II', code: 'PHYS202', grade: 'A-', credits: 3, instructor: 'Dr. Brown', room: 'PHYS-LAB', time: 'MWF 2:00-2:50 PM' },
                    { name: 'Technical Writing', code: 'ENG301', grade: 'A', credits: 3, instructor: 'Prof. Davis', room: 'ENG-102', time: 'TTh 1:00-2:15 PM' },
                    { name: 'Database Systems', code: 'CS350', grade: 'A-', credits: 3, instructor: 'Dr. Wilson', room: 'CS-Lab2', time: 'MW 3:00-4:15 PM' }
                ],
                todaySchedule: [
                    { time: '9:00 AM', course: 'Data Structures & Algorithms', room: 'CS-101', status: 'upcoming' },
                    { time: '11:00 AM', course: 'Calculus III', room: 'MATH-205', status: 'current' },
                    { time: '2:00 PM', course: 'Physics II Lab', room: 'PHYS-LAB', status: 'upcoming' },
                    { time: '3:00 PM', course: 'Database Systems', room: 'CS-Lab2', status: 'upcoming' }
                ],
                assignments: [
                    { course: 'CS301', title: 'Binary Tree Implementation', due: '2024-12-15', status: 'pending' },
                    { course: 'MATH301', title: 'Integration Problems Set 8', due: '2024-12-12', status: 'submitted' },
                    { course: 'PHYS202', title: 'Lab Report: Electromagnetic Induction', due: '2024-12-18', status: 'pending' }
                ],
                grades: {
                    'CS301': { midterm: 95, assignments: [92, 88, 95, 90], participation: 100 },
                    'MATH301': { midterm: 87, assignments: [85, 90, 88], quizzes: [90, 85, 92] },
                    'PHYS202': { midterm: 91, labs: [95, 88, 92, 90], final: null }
                }
            },
            'WU002': {
                name: 'Bob Smith',
                major: 'Mathematics',
                year: 'Senior',
                gpa: 3.6,
                cumulativeGPA: 3.58,
                credits: 95,
                totalCreditsNeeded: 120,
                rank: 18,
                degreeProgress: 79.2,
                expectedGraduation: 'December 2025',
                financials: {
                    tuitionBalance: 0,
                    scholarships: ['Academic Excellence - $3000'],
                    paymentStatus: 'Paid in Full'
                },
                courses: [
                    { name: 'Abstract Algebra', code: 'MATH401', grade: 'B+', credits: 4, instructor: 'Dr. Taylor', room: 'MATH-301', time: 'MWF 10:00-10:50 AM' },
                    { name: 'Real Analysis', code: 'MATH402', grade: 'A-', credits: 4, instructor: 'Prof. Anderson', room: 'MATH-205', time: 'TTh 1:00-2:15 PM' },
                    { name: 'Advanced Statistics', code: 'STAT401', grade: 'A', credits: 3, instructor: 'Dr. Lee', room: 'STAT-101', time: 'MWF 3:00-3:50 PM' },
                    { name: 'Mathematical Modeling', code: 'MATH450', grade: 'B+', credits: 3, instructor: 'Prof. Garcia', room: 'MATH-210', time: 'TTh 9:30-10:45 AM' }
                ],
                todaySchedule: [
                    { time: '9:30 AM', course: 'Mathematical Modeling', room: 'MATH-210', status: 'completed' },
                    { time: '10:00 AM', course: 'Abstract Algebra', room: 'MATH-301', status: 'current' },
                    { time: '1:00 PM', course: 'Real Analysis', room: 'MATH-205', status: 'upcoming' },
                    { time: '3:00 PM', course: 'Advanced Statistics', room: 'STAT-101', status: 'upcoming' }
                ],
                assignments: [
                    { course: 'MATH401', title: 'Group Theory Problem Set', due: '2024-12-16', status: 'submitted' },
                    { course: 'MATH402', title: 'Convergence Proof Assignment', due: '2024-12-14', status: 'pending' },
                    { course: 'STAT401', title: 'Data Analysis Project', due: '2024-12-20', status: 'in-progress' }
                ],
                grades: {
                    'MATH401': { midterm: 85, assignments: [88, 82, 90], participation: 95 },
                    'MATH402': { midterm: 92, assignments: [90, 94, 88, 91], quizzes: [85, 90] },
                    'STAT401': { midterm: 96, projects: [94, 92], participation: 100 }
                }
            }
        };

        // Enhanced announcements with priorities and actions
        const announcements = [
            {
                id: 1,
                date: 'Dec 9, 2024',
                title: 'Final Exam Schedule Released',
                content: 'Final exams begin December 16th. Check your personalized exam schedule in the Academics section.',
                priority: 'high',
                type: 'academic',
                action: 'View Schedule',
                read: false
            },
            {
                id: 2,
                date: 'Dec 8, 2024',
                title: 'Spring 2025 Registration Now Open',
                content: 'Course registration for Spring 2025 is now available. Early registration ends December 20th.',
                priority: 'high',
                type: 'registration',
                action: 'Register Now',
                read: false
            },
            {
                id: 3,
                date: 'Dec 7, 2024',
                title: 'Library Extended Hours During Finals',
                content: 'The library will be open 24/7 from December 14-20 to support your study needs.',
                priority: 'medium',
                type: 'campus',
                action: null,
                read: true
            },
            {
                id: 4,
                date: 'Dec 5, 2024',
                title: 'Scholarship Applications Available',
                content: 'Applications for merit-based scholarships for 2025-2026 are now available.',
                priority: 'medium',
                type: 'financial',
                action: 'Apply Now',
                read: true
            },
            {
                id: 5,
                date: 'Dec 3, 2024',
                title: 'Winter Break Campus Closure',
                content: 'Campus facilities will be closed December 21 - January 8. Emergency contacts remain available.',
                priority: 'low',
                type: 'campus',
                action: null,
                read: true
            }
        ];

        // Available courses for enrollment
        const availableCourses = [
            { code: 'CS401', name: 'Software Engineering', credits: 4, seats: 15, instructor: 'Dr. Thompson', time: 'MWF 9:00-9:50 AM' },
            { code: 'CS410', name: 'Machine Learning', credits: 3, seats: 8, instructor: 'Prof. Chen', time: 'TTh 2:00-3:15 PM' },
            { code: 'MATH350', name: 'Discrete Mathematics', credits: 3, seats: 12, instructor: 'Dr. Rodriguez', time: 'MWF 11:00-11:50 AM' },
            { code: 'PHYS301', name: 'Quantum Physics', credits: 4, seats: 10, instructor: 'Dr. Kumar', time: 'TTh 10:00-11:15 AM' },
            { code: 'ENG302', name: 'Advanced Composition', credits: 3, seats: 20, instructor: 'Prof. Williams', time: 'MWF 1:00-1:50 PM' }
        ];

        // Current semester important dates
        const importantDates = [
            { date: '2024-12-10', event: 'Last Day to Drop Classes', type: 'deadline' },
            { date: '2024-12-15', event: 'Spring Registration Deadline', type: 'registration' },
            { date: '2024-12-16', event: 'Final Exams Begin', type: 'exam' },
            { date: '2024-12-20', event: 'Semester Ends', type: 'academic' },
            { date: '2025-01-15', event: 'Spring Semester Begins', type: 'academic' }
        ];

        // Enhanced dashboard initialization
        function initializeDashboard() {
            const student = studentDatabase[currentStudent.id] || studentDatabase['WU001'];
            
            // Update user info with enhanced data
            document.getElementById('userName').textContent = student.name;
            document.getElementById('userId').textContent = `${currentStudent.id} ‚Ä¢ ${student.year} ‚Ä¢ ${student.major}`;
            document.getElementById('welcomeName').textContent = student.name.split(' ')[0];
            
            // Update academic statistics
            document.getElementById('currentGPA').textContent = student.gpa;
            document.getElementById('creditsEarned').textContent = student.credits;
            document.getElementById('semesterRank').textContent = student.rank;
            
            // Update degree progress
            const progressPercentage = Math.round((student.credits / student.totalCreditsNeeded) * 100);
            document.getElementById('degreeProgress').textContent = `${progressPercentage}%`;
            document.querySelector('.progress-fill').style.width = `${progressPercentage}%`;
            
            // Load dynamic content
            loadCourses(student.courses);
            loadTodaySchedule(student.todaySchedule);
            loadAnnouncements();
            updateAssignmentReminders(student.assignments);
            
            // Start real-time updates
            setInterval(updateCurrentTime, 1000);
            setInterval(checkUpcomingClasses, 60000); // Check every minute
            
            showNotification(`Welcome back, ${student.name.split(' ')[0]}! You have ${getUnreadAnnouncementsCount()} new announcements.`, 'info');
        }

        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: true 
            });
            
            // Update any time displays and check for class status updates
            updateClassStatus();
        }

        function updateClassStatus() {
            const now = new Date();
            const currentTime = now.getHours() * 100 + now.getMinutes();
            
            document.querySelectorAll('#scheduleTable tr').forEach((row, index) => {
                const student = studentDatabase[currentStudent.id];
                if (student && student.todaySchedule[index]) {
                    const classTime = parseTime(student.todaySchedule[index].time);
                    if (Math.abs(currentTime - classTime) <= 30) { // Within 30 minutes
                        row.classList.add('current-class');
                    } else {
                        row.classList.remove('current-class');
                    }
                }
            });
        }

        function parseTime(timeString) {
            const [time, modifier] = timeString.split(' ');
            let [hours, minutes] = time.split(':').map(Number);
            if (modifier === 'PM' && hours !== 12) hours += 12;
            if (modifier === 'AM' && hours === 12) hours = 0;
            return hours * 100 + minutes;
        }

        function checkUpcomingClasses() {
            const student = studentDatabase[currentStudent.id];
            if (!student) return;
            
            const now = new Date();
            const currentTime = now.getHours() * 100 + now.getMinutes();
            
            student.todaySchedule.forEach(classItem => {
                const classTime = parseTime(classItem.time);
                const timeDiff = classTime - currentTime;
                
                // Notify 15 minutes before class
                if (timeDiff > 0 && timeDiff <= 15) {
                    showNotification(`üìö Reminder: ${classItem.course} starts in ${timeDiff} minutes (${classItem.room})`, 'info');
                }
            });
        }

        function loadCourses(courses) {
            const courseList = document.getElementById('courseList');
            courseList.innerHTML = '';
            
            courses.slice(0, 4).forEach(course => { // Show only first 4 courses
                const gradeClass = course.grade.startsWith('A') ? 'grade-a' : 
                                  course.grade.startsWith('B') ? 'grade-b' : 'grade-c';
                
                courseList.innerHTML += `
                    <li class="course-item" onclick="viewCourseDetails('${course.code}')" style="cursor: pointer;">
                        <div class="course-info">
                            <h4>${course.name}</h4>
                            <p>${course.code} ‚Ä¢ ${course.credits} Credits ‚Ä¢ ${course.instructor}</p>
                            <small style="color: #666;">${course.time}</small>
                        </div>
                        <div class="course-grade ${gradeClass}">${course.grade}</div>
                    </li>
                `;
            });
            
            if (courses.length > 4) {
                courseList.innerHTML += `<li style="text-align: center; padding: 10px; color: #666;">+${courses.length - 4} more courses</li>`;
            }
        }

        function loadTodaySchedule(schedule) {
            const scheduleTable = document.getElementById('scheduleTable');
            scheduleTable.innerHTML = '';
            
            schedule.forEach((item, index) => {
                const statusClass = item.status === 'current' ? 'current-class' : '';
                const statusIcon = item.status === 'completed' ? '‚úÖ' : 
                                  item.status === 'current' ? 'üìç' : '‚è∞';
                
                scheduleTable.innerHTML += `
                    <tr class="${statusClass}" onclick="viewClassDetails('${item.course}')" style="cursor: pointer;">
                        <td>${statusIcon} ${item.time}</td>
                        <td>${item.course}</td>
                        <td>${item.room}</td>
                    </tr>
                `;
            });
        }

        function loadAnnouncements() {
            const announcementsList = document.getElementById('announcementsList');
            announcementsList.innerHTML = '';
            
            announcements.slice(0, 3).forEach(announcement => {
                const priorityColor = announcement.priority === 'high' ? '#e74c3c' : 
                                     announcement.priority === 'medium' ? '#f39c12' : '#95a5a6';
                const readClass = announcement.read ? '' : 'unread';
                
                announcementsList.innerHTML += `
                    <div class="announcement-item ${readClass}" onclick="readAnnouncement(${announcement.id})" style="cursor: pointer; border-left-color: ${priorityColor};">
                        <div class="announcement-date">
                            ${announcement.date} 
                            ${!announcement.read ? '<span style="color: #e74c3c; font-weight: bold;">‚Ä¢ NEW</span>' : ''}
                        </div>
                        <div class="announcement-title">${announcement.title}</div>
                        <div>${announcement.content}</div>
                        ${announcement.action ? `<button class="btn btn-primary" style="margin-top: 10px; padding: 5px 10px; font-size: 0.8em;" onclick="handleAnnouncementAction('${announcement.action}', event)">${announcement.action}</button>` : ''}
                    </div>
                `;
            });
        }

        function updateAssignmentReminders(assignments) {
            const pendingAssignments = assignments.filter(a => a.status === 'pending');
            if (pendingAssignments.length > 0) {
                // Add assignment reminder to the dashboard
                setTimeout(() => {
                    showNotification(`üìù You have ${pendingAssignments.length} pending assignments!`, 'info');
                }, 3000);
            }
        }

        function getUnreadAnnouncementsCount() {
            return announcements.filter(a => !a.read).length;
        }

        // Utility Functions
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed; top: 20px; right: 20px; z-index: 1000;
                padding: 15px 20px; border-radius: 5px; color: white;
                background: ${type === 'success' ? '#27ae60' : type === 'error' ? '#e74c3c' : '#3498db'};
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                transform: translateX(300px); transition: transform 0.3s ease;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.style.transform = 'translateX(0)', 100);
            setTimeout(() => {
                notification.style.transform = 'translateX(300px)';
                setTimeout(() => document.body.removeChild(notification), 300);
            }, 4000);
        }

        function showModal(title, content, actions = []) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: 2000;
                background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: white; border-radius: 10px; padding: 30px; max-width: 600px;
                width: 90%; max-height: 80vh; overflow-y: auto;
            `;
            
            modalContent.innerHTML = `
                <h2 style="margin-bottom: 20px; color: #2c5530;">${title}</h2>
                <div style="margin-bottom: 20px;">${content}</div>
                <div style="text-align: right;">
                    ${actions.map(action => `<button class="btn ${action.class}" onclick="${action.onclick}" style="margin-left: 10px;">${action.text}</button>`).join('')}
                    <button class="btn btn-secondary" onclick="closeModal()" style="margin-left: 10px;">Close</button>
                </div>
            `;
            
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
            window.currentModal = modal;
        }

        function closeModal() {
            if (window.currentModal) {
                document.body.removeChild(window.currentModal);
                window.currentModal = null;
            }
        }

        // Enhanced Action Functions
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
            localStorage.removeItem('currentStudent');
            localStorage.removeItem('isLoggedIn');
                showNotification('Logged out successfully!', 'success');
                setTimeout(() => window.location.href = '/waldorf_chrome.html', 1000);
            }
        }

        function viewTranscript() {
            const student = studentDatabase[currentStudent.id];
            showEnhancedTranscript(student);
        }

        function showEnhancedTranscript(student) {
            // Calculate academic statistics
            const totalCredits = Object.values(student.academicHistory).reduce((sum, semester) => sum + semester.credits, 0);
            const weightedGPA = Object.values(student.academicHistory).reduce((sum, semester) => sum + (semester.semesterGPA * semester.credits), 0) / totalCredits;
            const totalCourses = Object.values(student.academicHistory).reduce((sum, semester) => sum + semester.courses.length, 0);
            
            // Count grade distribution
            const gradeDistribution = { 'A': 0, 'B': 0, 'C': 0, 'D': 0, 'F': 0 };
            Object.values(student.academicHistory).forEach(semester => {
                semester.courses.forEach(course => {
                    const gradeType = course.grade.charAt(0);
                    if (gradeDistribution[gradeType] !== undefined) {
                        gradeDistribution[gradeType]++;
                    }
                });
            });

            const transcriptHTML = `
                <div class="transcript-container">
                    <!-- Official Header -->
                    <div class="transcript-header">
                        <div class="transcript-logo">üéì</div>
                        <div class="transcript-title">WALDORF COLLEGES & UNIVERSITIES</div>
                        <div class="transcript-subtitle">OFFICIAL ACADEMIC TRANSCRIPT</div>
                        <div style="font-size: 0.9em; color: #666; margin-top: 10px;">
                            Transcript Date: ${new Date().toLocaleDateString()}<br>
                            Document ID: WU-T-${Date.now()}
                        </div>
                    </div>

                    <!-- Student Information -->
                    <div class="transcript-info">
                        <div class="transcript-section">
                            <h4>üìã Student Information</h4>
                            <p><strong>Name:</strong> ${student.name}</p>
                            <p><strong>Student ID:</strong> ${student.studentId}</p>
                            <p><strong>Date of Birth:</strong> ${student.dateOfBirth}</p>
                            <p><strong>Enrollment Date:</strong> ${student.enrollmentDate}</p>
                            <p><strong>Expected Graduation:</strong> ${student.expectedGraduation}</p>
                        </div>
                        <div class="transcript-section">
                            <h4>üéØ Program Information</h4>
                            <p><strong>Major:</strong> ${student.major}</p>
                            <p><strong>Minor:</strong> ${student.minor}</p>
                            <p><strong>Academic Standing:</strong> ${student.academicStanding}</p>
                            <p><strong>Classification:</strong> ${student.year}</p>
                            <p><strong>Class Rank:</strong> ${student.rank} of 450</p>
                        </div>
                    </div>

                    <!-- Academic Summary -->
                    <div class="transcript-summary">
                        <h3>üìä Academic Summary</h3>
                        <div class="summary-stats">
                            <div class="summary-stat">
                                <h3>${student.cumulativeGPA}</h3>
                                <p>Cumulative GPA</p>
                            </div>
                            <div class="summary-stat">
                                <h3>${totalCredits}</h3>
                                <p>Total Credits</p>
                            </div>
                            <div class="summary-stat">
                                <h3>${totalCourses}</h3>
                                <p>Courses Completed</p>
                            </div>
                            <div class="summary-stat">
                                <h3>${Math.round((totalCredits / student.totalCreditsNeeded) * 100)}%</h3>
                                <p>Degree Progress</p>
                            </div>
                        </div>
                    </div>

                    <!-- Academic History by Semester -->
                    <div style="margin: 30px 0;">
                        <h3 style="color: #2c5530; margin-bottom: 20px; text-align: center; font-size: 1.5em;">üìö Academic History</h3>
                        ${Object.entries(student.academicHistory).map(([semester, data]) => `
                            <div class="semester-section">
                                <div class="semester-header">
                                    ${semester} - Credits: ${data.credits} | Semester GPA: ${data.semesterGPA}
                                </div>
                                <div class="semester-content">
                                    <div style="display: grid; grid-template-columns: 2fr 1fr 80px 80px 100px; gap: 15px; font-weight: bold; padding-bottom: 10px; border-bottom: 2px solid #ddd; margin-bottom: 15px;">
                                        <div>Course Title</div>
                                        <div>Course Code</div>
                                        <div>Credits</div>
                                        <div>Grade</div>
                                        <div>Instructor</div>
                                    </div>
                                    ${data.courses.map(course => {
                                        const gradeClass = getGradeClass(course.grade);
                                        return `
                                            <div class="course-row">
                                                <div class="course-details">
                                                    <h5>${course.name}</h5>
                                                </div>
                                                <div>${course.code}</div>
                                                <div style="text-align: center;">${course.credits}</div>
                                                <div style="text-align: center;">
                                                    <span class="grade-highlight ${gradeClass}">${course.grade}</span>
                                                </div>
                                                <div style="font-size: 0.9em;">${course.instructor}</div>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <!-- Grade Distribution -->
                    <div class="transcript-section" style="margin: 30px 0;">
                        <h4>üìà Grade Distribution</h4>
                        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px; margin-top: 15px;">
                            ${Object.entries(gradeDistribution).map(([grade, count]) => `
                                <div style="text-align: center; padding: 10px; background: white; border-radius: 8px; border: 2px solid #ddd;">
                                    <div style="font-size: 1.5em; font-weight: bold; color: #2c5530;">${count}</div>
                                    <div style="font-size: 0.9em; color: #666;">${grade} Grades</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Honors and Awards -->
                    ${student.honors && student.honors.length > 0 ? `
                        <div class="transcript-section" style="margin: 30px 0;">
                            <h4>üèÜ Honors & Awards</h4>
                            <ul style="margin-left: 20px;">
                                ${student.honors.map(honor => `<li style="margin: 8px 0;">${honor}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}

                    <!-- Degree Requirements Progress -->
                    <div class="transcript-section" style="margin: 30px 0;">
                        <h4>üìã Degree Requirements Progress</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #27ae60;">
                                <strong>Core Requirements:</strong> 45/48 credits<br>
                                <div style="background: #e9ecef; height: 8px; border-radius: 4px; margin-top: 5px;">
                                    <div style="background: #27ae60; height: 100%; width: 94%; border-radius: 4px;"></div>
                                </div>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #3498db;">
                                <strong>Major Requirements:</strong> 42/45 credits<br>
                                <div style="background: #e9ecef; height: 8px; border-radius: 4px; margin-top: 5px;">
                                    <div style="background: #3498db; height: 100%; width: 93%; border-radius: 4px;"></div>
                                </div>
                            </div>
                            <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #f39c12;">
                                <strong>Electives:</strong> 18/27 credits<br>
                                <div style="background: #e9ecef; height: 8px; border-radius: 4px; margin-top: 5px;">
                                    <div style="background: #f39c12; height: 100%; width: 67%; border-radius: 4px;"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Footer -->
                    <div class="transcript-footer">
                        <p><strong>This is an official transcript from Waldorf Colleges & Universities</strong></p>
                        <p>This document contains a complete record of academic work undertaken by the above-named student.</p>
                        <p>Transcript authenticated on ${new Date().toLocaleDateString()} by the Office of the Registrar</p>
                        <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #ddd;">
                            <strong>Registrar:</strong> Dr. Sarah Mitchell<br>
                            <strong>Phone:</strong> (555) 123-4567 | <strong>Email:</strong> registrar@waldorf.edu
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="transcript-actions no-print">
                        <button class="btn btn-primary" onclick="printTranscript()" style="margin: 10px;">üñ®Ô∏è Print Official Transcript</button>
                        <button class="btn btn-secondary" onclick="emailTranscript()" style="margin: 10px;">üìß Email Transcript</button>
                        <button class="btn btn-secondary" onclick="downloadTranscriptPDF()" style="margin: 10px;">üìÑ Download PDF</button>
                        <button class="btn btn-secondary" onclick="requestOfficialTranscript()" style="margin: 10px;">üìã Request Official Copy</button>
                    </div>
                </div>
            `;

            // Create enhanced modal
            const modal = document.createElement('div');
            modal.className = 'enhanced-modal';
            modal.innerHTML = `
                <div class="enhanced-modal-content">
                    <div class="modal-header no-print">
                        <h2>üìã Official Academic Transcript</h2>
                        <button class="modal-close" onclick="closeEnhancedModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        ${transcriptHTML}
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
            window.currentEnhancedModal = modal;

            // Add click outside to close
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeEnhancedModal();
                }
            });
        }

        function getGradeClass(grade) {
            if (grade.startsWith('A')) return 'grade-a';
            if (grade.startsWith('B')) return 'grade-b';
            if (grade.startsWith('C')) return 'grade-c';
            if (grade.startsWith('D')) return 'grade-d';
            return 'grade-f';
        }

        function closeEnhancedModal() {
            if (window.currentEnhancedModal) {
                document.body.removeChild(window.currentEnhancedModal);
                window.currentEnhancedModal = null;
            }
        }

        function downloadTranscriptPDF() {
            showNotification('üìÑ Generating PDF transcript... This may take a moment.', 'info');
            setTimeout(() => {
                showNotification('‚úÖ PDF transcript downloaded successfully!', 'success');
            }, 2000);
        }

        function viewGrades() {
            const student = studentDatabase[currentStudent.id];
            let gradesHTML = '<div>';
            
            Object.keys(student.grades).forEach(courseCode => {
                const course = student.courses.find(c => c.code === courseCode);
                const grades = student.grades[courseCode];
                
                gradesHTML += `
                    <div style="background: #f8f9fa; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                        <h4>${course.name} (${courseCode})</h4>
                        <p><strong>Current Grade:</strong> ${course.grade}</p>
                `;
                
                if (grades.midterm) gradesHTML += `<p>Midterm: ${grades.midterm}%</p>`;
                if (grades.assignments) gradesHTML += `<p>Assignments Average: ${(grades.assignments.reduce((a,b) => a+b, 0)/grades.assignments.length).toFixed(1)}%</p>`;
                if (grades.quizzes) gradesHTML += `<p>Quiz Average: ${(grades.quizzes.reduce((a,b) => a+b, 0)/grades.quizzes.length).toFixed(1)}%</p>`;
                if (grades.labs) gradesHTML += `<p>Lab Average: ${(grades.labs.reduce((a,b) => a+b, 0)/grades.labs.length).toFixed(1)}%</p>`;
                
                gradesHTML += '</div>';
            });
            
            gradesHTML += '</div>';
            
            showModal('Detailed Grades', gradesHTML, [
                { text: 'Grade Report', class: 'btn-primary', onclick: 'generateGradeReport()' }
            ]);
        }

        function enrollCourses() {
            let enrollHTML = `
                <p>Available courses for Spring 2025 enrollment:</p>
                <div style="max-height: 300px; overflow-y: auto;">
            `;
            
            availableCourses.forEach(course => {
                enrollHTML += `
                    <div style="border: 1px solid #ddd; padding: 15px; margin-bottom: 10px; border-radius: 5px;">
                        <h4>${course.name} (${course.code})</h4>
                        <p><strong>Credits:</strong> ${course.credits} | <strong>Instructor:</strong> ${course.instructor}</p>
                        <p><strong>Schedule:</strong> ${course.time}</p>
                        <p><strong>Available Seats:</strong> ${course.seats}</p>
                        <button class="btn btn-primary" onclick="enrollInCourse('${course.code}')" style="margin-top: 5px;">Enroll</button>
                    </div>
                `;
            });
            
            enrollHTML += '</div>';
            
            showModal('Course Enrollment - Spring 2025', enrollHTML);
        }

        function enrollInCourse(courseCode) {
            const course = availableCourses.find(c => c.code === courseCode);
            if (course && course.seats > 0) {
                course.seats--;
                showNotification(`‚úÖ Successfully enrolled in ${course.name}!`, 'success');
                closeModal();
            } else {
                showNotification('‚ùå Course is full or not available!', 'error');
            }
        }

        function viewAllCourses() {
            const student = studentDatabase[currentStudent.id];
            let coursesHTML = '<div>';
            
            student.courses.forEach(course => {
                coursesHTML += `
                    <div style="border: 1px solid #ddd; padding: 15px; margin-bottom: 10px; border-radius: 5px;">
                        <h4>${course.name}</h4>
                        <p><strong>Code:</strong> ${course.code} | <strong>Credits:</strong> ${course.credits} | <strong>Grade:</strong> ${course.grade}</p>
                        <p><strong>Instructor:</strong> ${course.instructor}</p>
                        <p><strong>Schedule:</strong> ${course.time}</p>
                        <p><strong>Room:</strong> ${course.room}</p>
                        <button class="btn btn-primary" onclick="viewCourseDetails('${course.code}')" style="margin-top: 5px;">View Details</button>
                    </div>
                `;
            });
            
            coursesHTML += '</div>';
            
            showModal('All Current Courses', coursesHTML);
        }

        function viewCourseDetails(courseCode) {
            const student = studentDatabase[currentStudent.id];
            const course = student.courses.find(c => c.code === courseCode);
            const grades = student.grades[courseCode];
            
            let detailsHTML = `
                <div>
                    <h3>${course.name}</h3>
                    <p><strong>Code:</strong> ${course.code}</p>
                    <p><strong>Instructor:</strong> ${course.instructor}</p>
                    <p><strong>Schedule:</strong> ${course.time}</p>
                    <p><strong>Room:</strong> ${course.room}</p>
                    <p><strong>Credits:</strong> ${course.credits}</p>
                    <p><strong>Current Grade:</strong> ${course.grade}</p>
                    <hr>
                    <h4>Grade Breakdown:</h4>
            `;
            
            if (grades) {
                if (grades.midterm) detailsHTML += `<p>Midterm Exam: ${grades.midterm}%</p>`;
                if (grades.assignments) detailsHTML += `<p>Assignments: ${grades.assignments.join(', ')}% (Avg: ${(grades.assignments.reduce((a,b) => a+b, 0)/grades.assignments.length).toFixed(1)}%)</p>`;
                if (grades.quizzes) detailsHTML += `<p>Quizzes: ${grades.quizzes.join(', ')}% (Avg: ${(grades.quizzes.reduce((a,b) => a+b, 0)/grades.quizzes.length).toFixed(1)}%)</p>`;
                if (grades.labs) detailsHTML += `<p>Labs: ${grades.labs.join(', ')}% (Avg: ${(grades.labs.reduce((a,b) => a+b, 0)/grades.labs.length).toFixed(1)}%)</p>`;
            }
            
            detailsHTML += '</div>';
            
            showModal(`Course Details - ${course.code}`, detailsHTML);
        }

        function viewFullSchedule() {
            const student = studentDatabase[currentStudent.id];
            let scheduleHTML = `
                <div style="overflow-x: auto;">
                    <h3>Weekly Schedule</h3>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                        <tr style="background: #e9ecef;">
                            <th style="border: 1px solid #ddd; padding: 10px;">Time</th>
                            <th style="border: 1px solid #ddd; padding: 10px;">Monday</th>
                            <th style="border: 1px solid #ddd; padding: 10px;">Tuesday</th>
                            <th style="border: 1px solid #ddd; padding: 10px;">Wednesday</th>
                            <th style="border: 1px solid #ddd; padding: 10px;">Thursday</th>
                            <th style="border: 1px solid #ddd; padding: 10px;">Friday</th>
                        </tr>
            `;
            
            const timeSlots = ['9:00 AM', '10:00 AM', '11:00 AM', '12:00 PM', '1:00 PM', '2:00 PM', '3:00 PM', '4:00 PM'];
            
            timeSlots.forEach(time => {
                scheduleHTML += `<tr><td style="border: 1px solid #ddd; padding: 10px; font-weight: bold;">${time}</td>`;
                
                for (let i = 0; i < 5; i++) {
                    const course = student.courses.find(c => c.time.includes(time) && 
                        ((i === 0 && c.time.includes('M')) ||
                         (i === 1 && c.time.includes('T') && !c.time.includes('Th')) ||
                         (i === 2 && c.time.includes('W')) ||
                         (i === 3 && c.time.includes('Th')) ||
                         (i === 4 && c.time.includes('F'))));
                    
                    scheduleHTML += `<td style="border: 1px solid #ddd; padding: 10px;">${course ? `${course.name}<br><small>${course.room}</small>` : ''}</td>`;
                }
                
                scheduleHTML += '</tr>';
            });
            
            scheduleHTML += '</table></div>';
            
            showModal('Full Weekly Schedule', scheduleHTML);
        }

        function viewAllAnnouncements() {
            let announcementsHTML = '<div>';
            
            announcements.forEach(announcement => {
                const priorityColor = announcement.priority === 'high' ? '#e74c3c' : 
                                     announcement.priority === 'medium' ? '#f39c12' : '#95a5a6';
                
                announcementsHTML += `
                    <div style="border-left: 4px solid ${priorityColor}; background: #f8f9fa; padding: 15px; margin-bottom: 15px; border-radius: 5px;">
                        <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                            ${announcement.date} ‚Ä¢ ${announcement.type.toUpperCase()} ‚Ä¢ ${announcement.priority.toUpperCase()} PRIORITY
                        </div>
                        <h4 style="color: #2c5530; margin-bottom: 8px;">${announcement.title}</h4>
                        <p>${announcement.content}</p>
                        ${announcement.action ? `<button class="btn btn-primary" style="margin-top: 10px; padding: 5px 10px; font-size: 0.8em;">${announcement.action}</button>` : ''}
                    </div>
                `;
            });
            
            announcementsHTML += '</div>';
            
            showModal('All Announcements', announcementsHTML);
        }

        function payTuition() {
            const student = studentDatabase[currentStudent.id];
            const balance = student.financials.tuitionBalance;
            
            let paymentHTML = `
                <div>
                    <h3>Tuition Payment</h3>
                    <p><strong>Current Balance:</strong> $${balance.toLocaleString()}</p>
                    <p><strong>Payment Status:</strong> ${student.financials.paymentStatus}</p>
                    <hr>
                    <h4>Scholarships Applied:</h4>
                    <ul>
                        ${student.financials.scholarships.map(scholarship => `<li>${scholarship}</li>`).join('')}
                    </ul>
                    ${balance > 0 ? `
                        <hr>
                        <p>Payment Amount: <input type="number" id="paymentAmount" placeholder="Enter amount" max="${balance}" style="padding: 5px; margin-left: 10px;"></p>
                        <p>Payment Method: 
                            <select id="paymentMethod" style="padding: 5px; margin-left: 10px;">
                                <option>Credit Card</option>
                                <option>Bank Transfer</option>
                                <option>Student Account</option>
                            </select>
                        </p>
                    ` : '<p style="color: #27ae60; font-weight: bold;">‚úÖ Your account is paid in full!</p>'}
                </div>
            `;
            
            const actions = balance > 0 ? [
                { text: 'Process Payment', class: 'btn-primary', onclick: 'processPayment()' },
                { text: 'Setup Payment Plan', class: 'btn-secondary', onclick: 'setupPaymentPlan()' }
            ] : [];
            
            showModal('Tuition & Fees', paymentHTML, actions);
        }

        function processPayment() {
            const amount = document.getElementById('paymentAmount').value;
            const method = document.getElementById('paymentMethod').value;
            
            if (amount && amount > 0) {
                showNotification(`‚úÖ Payment of $${amount} processed via ${method}!`, 'success');
                closeModal();
                
                // Update student balance
                const student = studentDatabase[currentStudent.id];
                student.financials.tuitionBalance -= parseFloat(amount);
                if (student.financials.tuitionBalance <= 0) {
                    student.financials.paymentStatus = 'Paid in Full';
                }
            } else {
                showNotification('‚ùå Please enter a valid payment amount!', 'error');
            }
        }

        function requestTranscript() {
            let transcriptHTML = `
                <div>
                    <h3>Official Transcript Request</h3>
                    <p>Request official transcripts to be sent to other institutions or employers.</p>
                    <hr>
                    <p><strong>Recipient Information:</strong></p>
                    <p>Institution/Organization: <input type="text" id="recipientName" placeholder="Enter name" style="padding: 5px; width: 100%; margin: 5px 0;"></p>
                    <p>Address: <textarea id="recipientAddress" placeholder="Enter full address" style="padding: 5px; width: 100%; height: 60px; margin: 5px 0;"></textarea></p>
                    <p>Purpose: 
                        <select id="transcriptPurpose" style="padding: 5px; margin-left: 10px;">
                            <option>Graduate School Application</option>
                            <option>Transfer Application</option>
                            <option>Employment Verification</option>
                            <option>Personal Records</option>
                        </select>
                    </p>
                    <p>Delivery Method: 
                        <select id="deliveryMethod" style="padding: 5px; margin-left: 10px;">
                            <option>Electronic (PDF)</option>
                            <option>Standard Mail</option>
                            <option>Expedited Mail</option>
                        </select>
                    </p>
                    <p><strong>Processing Fee:</strong> $10.00</p>
                </div>
            `;
            
            showModal('Request Official Transcript', transcriptHTML, [
                { text: 'Submit Request', class: 'btn-primary', onclick: 'submitTranscriptRequest()' }
            ]);
        }

        function submitTranscriptRequest() {
            const recipient = document.getElementById('recipientName').value;
            const address = document.getElementById('recipientAddress').value;
            
            if (recipient && address) {
                showNotification('‚úÖ Transcript request submitted successfully! Processing time: 3-5 business days.', 'success');
                closeModal();
            } else {
                showNotification('‚ùå Please fill in all required fields!', 'error');
            }
        }

        function updateProfile() {
            const student = studentDatabase[currentStudent.id];
            let profileHTML = `
                <div>
                    <h3>Update Profile Information</h3>
                    <p><strong>Personal Information:</strong></p>
                    <p>Full Name: <input type="text" id="fullName" value="${student.name}" style="padding: 5px; width: 100%; margin: 5px 0;"></p>
                    <p>Email: <input type="email" id="email" placeholder="student@waldorf.edu" style="padding: 5px; width: 100%; margin: 5px 0;"></p>
                    <p>Phone: <input type="tel" id="phone" placeholder="(555) 123-4567" style="padding: 5px; width: 100%; margin: 5px 0;"></p>
                    <p>Address: <textarea id="address" placeholder="Enter home address" style="padding: 5px; width: 100%; height: 60px; margin: 5px 0;"></textarea></p>
                    <hr>
                    <p><strong>Academic Information:</strong></p>
                    <p>Major: <input type="text" id="major" value="${student.major}" readonly style="padding: 5px; width: 100%; margin: 5px 0; background: #f8f9fa;"></p>
                    <p>Expected Graduation: <input type="text" id="graduation" value="${student.expectedGraduation}" readonly style="padding: 5px; width: 100%; margin: 5px 0; background: #f8f9fa;"></p>
                    <hr>
                    <p><strong>Emergency Contact:</strong></p>
                    <p>Name: <input type="text" id="emergencyName" placeholder="Contact name" style="padding: 5px; width: 100%; margin: 5px 0;"></p>
                    <p>Phone: <input type="tel" id="emergencyPhone" placeholder="Emergency phone" style="padding: 5px; width: 100%; margin: 5px 0;"></p>
                    <p>Relationship: <input type="text" id="emergencyRelation" placeholder="Relationship" style="padding: 5px; width: 100%; margin: 5px 0;"></p>
                </div>
            `;
            
            showModal('Update Profile', profileHTML, [
                { text: 'Save Changes', class: 'btn-primary', onclick: 'saveProfile()' }
            ]);
        }

        function saveProfile() {
            showNotification('‚úÖ Profile updated successfully!', 'success');
            closeModal();
        }

        function contactSupport() {
            let supportHTML = `
                <div>
                    <h3>Student Support Center</h3>
                    <p>Get help with academic, technical, or administrative issues.</p>
                    <hr>
                    <p><strong>Contact Information:</strong></p>
                    <p>üìû Phone: (555) 123-HELP (4357)</p>
                    <p>üìß Email: support@waldorf.edu</p>
                    <p>üïí Hours: Monday-Friday 8:00 AM - 6:00 PM</p>
                    <hr>
                    <p><strong>Submit a Support Ticket:</strong></p>
                    <p>Subject: <input type="text" id="supportSubject" placeholder="Brief description" style="padding: 5px; width: 100%; margin: 5px 0;"></p>
                    <p>Category: 
                        <select id="supportCategory" style="padding: 5px; margin-left: 10px;">
                            <option>Academic Advising</option>
                            <option>Technical Support</option>
                            <option>Financial Aid</option>
                            <option>Registration Issues</option>
                            <option>Campus Services</option>
                            <option>Other</option>
                        </select>
                    </p>
                    <p>Priority: 
                        <select id="supportPriority" style="padding: 5px; margin-left: 10px;">
                            <option>Low</option>
                            <option>Medium</option>
                            <option>High</option>
                            <option>Urgent</option>
                        </select>
                    </p>
                    <p>Description: <textarea id="supportDescription" placeholder="Describe your issue in detail" style="padding: 5px; width: 100%; height: 80px; margin: 5px 0;"></textarea></p>
                </div>
            `;
            
            showModal('Student Support', supportHTML, [
                { text: 'Submit Ticket', class: 'btn-primary', onclick: 'submitSupportTicket()' },
                { text: 'Live Chat', class: 'btn-secondary', onclick: 'startLiveChat()' }
            ]);
        }

        function submitSupportTicket() {
            const subject = document.getElementById('supportSubject').value;
            const description = document.getElementById('supportDescription').value;
            
            if (subject && description) {
                const ticketNumber = 'WU' + Math.floor(Math.random() * 10000);
                showNotification(`‚úÖ Support ticket #${ticketNumber} submitted! You'll receive an email confirmation shortly.`, 'success');
                closeModal();
            } else {
                showNotification('‚ùå Please fill in the subject and description!', 'error');
            }
        }

        // Additional utility functions
        function readAnnouncement(announcementId) {
            const announcement = announcements.find(a => a.id === announcementId);
            if (announcement) {
                announcement.read = true;
                loadAnnouncements(); // Refresh display
            }
        }

        function handleAnnouncementAction(action, event) {
            event.stopPropagation();
            
            switch(action) {
                case 'View Schedule':
                    viewFullSchedule();
                    break;
                case 'Register Now':
                    enrollCourses();
                    break;
                case 'Apply Now':
                    showNotification('üìù Redirecting to scholarship application portal...', 'info');
                    break;
                default:
                    showNotification('üîó Action functionality coming soon!', 'info');
            }
        }

        function viewClassDetails(courseName) {
            const student = studentDatabase[currentStudent.id];
            const course = student.courses.find(c => c.name === courseName || c.name.includes(courseName));
            
            if (course) {
                viewCourseDetails(course.code);
            } else {
                showNotification('‚ÑπÔ∏è Class details not available', 'info');
            }
        }

        function printTranscript() {
            showNotification('üñ®Ô∏è Preparing transcript for printing...', 'info');
            setTimeout(() => window.print(), 1000);
        }

        function emailTranscript() {
            showNotification('üìß Transcript sent to your registered email address!', 'success');
        }

        function generateGradeReport() {
            showNotification('üìä Generating detailed grade report...', 'info');
        }

        function setupPaymentPlan() {
            showNotification('üìã Payment plan options have been emailed to you!', 'info');
            closeModal();
        }

        function startLiveChat() {
            showNotification('üí¨ Connecting you to live chat support...', 'info');
            closeModal();
        }

        // Initialize dashboard when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeDashboard();
            
            // Add some welcome animations
            setTimeout(() => {
                document.querySelector('.welcome-section').style.transform = 'translateY(0)';
                document.querySelector('.welcome-section').style.opacity = '1';
            }, 300);
            
            // Stagger dashboard card animations
            document.querySelectorAll('.dashboard-card').forEach((card, index) => {
                setTimeout(() => {
                    card.style.transform = 'translateY(0)';
                    card.style.opacity = '1';
                }, 500 + (index * 100));
            });
            
            // Show system status notification
            setTimeout(() => {
                showNotification('üéì Student portal loaded successfully! All systems operational.', 'success');
            }, 1500);
        });

        // Add keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            if (event.ctrlKey || event.metaKey) {
                switch(event.key) {
                    case 't':
                        event.preventDefault();
                        viewTranscript();
                        break;
                    case 'g':
                        event.preventDefault();
                        viewGrades();
                        break;
                    case 's':
                        event.preventDefault();
                        viewFullSchedule();
                        break;
                    case 'e':
                        event.preventDefault();
                        enrollCourses();
                        break;
                }
            }
        });

        // Add CSS for initial animation states
        const animationCSS = document.createElement('style');
        animationCSS.textContent = `
            .welcome-section {
                transform: translateY(-20px);
                opacity: 0;
                transition: all 0.6s ease;
            }
            .dashboard-card {
                transform: translateY(20px);
                opacity: 0;
                transition: all 0.4s ease;
            }
            .unread {
                animation: glow 2s infinite;
            }
            @keyframes glow {
                0%, 100% { box-shadow: 0 5px 20px rgba(0,0,0,0.08); }
                50% { box-shadow: 0 5px 20px rgba(231, 76, 60, 0.2); }
            }
            .current-class {
                background: linear-gradient(90deg, #e8f5e8, #d4edda) !important;
                border-left: 4px solid #27ae60;
            }
            /* Enhanced button hover effects */
            .btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            }
            /* Modal entrance animation */
            .modal-content {
                animation: modalSlideIn 0.3s ease;
            }
            @keyframes modalSlideIn {
                from { transform: scale(0.8); opacity: 0; }
                to { transform: scale(1); opacity: 1; }
            }
        `;
        document.head.appendChild(animationCSS);

        // Error handling for missing elements
        window.addEventListener('error', function(event) {
            console.error('Student Portal Error:', event.error);
            showNotification('‚ö†Ô∏è A minor error occurred. Please refresh if issues persist.', 'error');
        });

        // Auto-save user preferences
        function saveUserPreferences() {
            const preferences = {
                lastVisit: new Date().toISOString(),
                dashboardView: 'default',
                notifications: true
            };
            localStorage.setItem('studentPreferences', JSON.stringify(preferences));
        }

        // Call save preferences on page unload
        window.addEventListener('beforeunload', saveUserPreferences);
    </script>
</body>
</html> 